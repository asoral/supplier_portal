var M=(z,v,y)=>new Promise((L,x)=>{var S=u=>{try{h(y.next(u))}catch(r){x(r)}},b=u=>{try{h(y.throw(u))}catch(r){x(r)}},h=u=>u.done?L(u.value):Promise.resolve(u.value).then(S,b);h((y=y.apply(z,v)).next())});import{c as X,l as se,m as g,y as U,M as O,p as oe,a as i,b as e,k,e as f,f as R,u as m,j as ne,F as Q,r as C,q as _,v as N,X as H,D as P,h as I,t as a,o,n as D,i as ie}from"./index-D5a6mMu4.js";import{t as p}from"./mosha-vue-toastify.es-VMk8UT0t.js";/* empty css              */import{C as J}from"./clock-P9NpKmqW.js";import{C as E}from"./circle-check-big-aW9m5Tw2.js";import{P as re}from"./plus-BlpZHZG-.js";import{S as le}from"./search-B3Y6NaGt.js";/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=X("file-question-mark",[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=X("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),ue={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8"},ce={class:"flex flex-col md:flex-row md:items-center md:justify-between mb-8 gap-4"},ge={class:"flex gap-3"},me={class:"grid grid-cols-1 gap-4 sm:grid-cols-4 mb-8"},pe={class:"truncate text-sm font-medium text-gray-500"},ye={class:"mt-1 text-2xl font-semibold tracking-tight text-gray-900"},be={class:"mb-6"},fe={class:"flex space-x-2"},ve=["onClick"],xe={class:"mb-6 flex items-center justify-between"},he={class:"relative max-w-sm flex-grow"},we={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},ke={key:0,class:"ml-4"},_e={key:0,class:"space-y-4"},Se={key:0,class:"text-center py-12 bg-white rounded-lg border border-dashed border-gray-300"},Qe={class:"flex items-start gap-4"},Ce={class:"mt-1"},je={key:0,class:"rounded-full bg-green-100 p-2"},qe={key:1,class:"rounded-full bg-orange-100 p-2"},Me={class:"flex-grow"},Re={class:"flex justify-between items-start"},Ne={class:"flex items-center gap-3 mb-1"},De={class:"text-base font-semibold text-gray-900"},Le={class:"text-xs font-mono text-gray-400"},Te={class:"text-sm text-gray-500 mb-4"},Ve={class:"bg-gray-50 rounded-lg p-4 mb-3 text-sm text-gray-800 font-medium whitespace-pre-wrap"},Ae={key:0,class:"bg-green-50 rounded-lg p-4 text-sm border border-green-100"},Fe={class:"text-green-800 font-medium pb-1 mb-1 border-b border-green-200/50 flex justify-between"},Pe={class:"text-xs opacity-75"},ze=["innerHTML"],Be={class:"text-xs text-gray-400 mt-2"},Ue={key:1,class:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6",role:"dialog","aria-modal":"true"},Oe={class:"relative transform overflow-hidden rounded-xl bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},He={class:"absolute right-0 top-0 hidden pr-4 pt-4 sm:block"},Ie={class:"space-y-4"},Je=["value"],Ee={class:"mt-6"},Xe=["disabled"],Ye={key:0,class:"animate-spin h-4 w-4 text-white",viewBox:"0 0 24 24"},$e={key:2,class:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6",role:"dialog","aria-modal":"true"},Ge={class:"relative transform overflow-hidden rounded-xl bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},Ke={class:"absolute right-0 top-0 hidden pr-4 pt-4 sm:block"},We={class:"space-y-4"},Ze=["value"],et=["value"],tt={class:"mt-6"},st=["disabled"],ot={key:0,class:"animate-spin h-4 w-4 text-white",viewBox:"0 0 24 24"},gt={__name:"Queries",setup(z){const v=se(),y=g("My Queries"),L=["My Queries","Questionnaires"],x=g(""),S=g(!0),b=g([]),h=g([]),u=g(!1),r=g({tender:"",subject:"",description:""}),T=g(!1),d=g({tender:"",type:"",reason:""}),Y=["Compliance Assessment","Technical Assessment"],V=()=>M(this,null,function*(){S.value=!0;try{const[n,t]=yield Promise.all([v.secureFetch("/api/method/supplier_portal.api.get_my_queries"),v.secureFetch("/api/method/supplier_portal.api.get_my_questionnaires")]),s=yield n.json(),w=yield t.json(),c=(s.message||[]).map(l=>({id:l.name,type:"Query",title:l.subject,ref:l.rfq,status:l.status,question:l.query,response:l.response,responseDate:l.response?"Answered":null,submitted:new Date(l.creation).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})),te=(w.message||[]).map(l=>({id:l.name,type:"Questionnaire",title:l.subject,ref:l.rfq,status:l.status,question:l.query,response:l.response,responseDate:l.response?"Answered":null,submitted:new Date(l.creation).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}));b.value=[...c,...te]}catch(n){console.error("Failed to fetch data:",n),p("Failed to load data",{type:"danger"})}finally{S.value=!1}}),$=()=>M(this,null,function*(){try{const t=yield(yield v.secureFetch("/api/resource/Request for Quotation?"+new URLSearchParams({fields:JSON.stringify(["name"]),limit_page_length:"50"}))).json();h.value=(t.data||[]).map(s=>s.name)}catch(n){console.error("Failed to fetch tenders:",n)}}),j=g(!1),G=()=>M(this,null,function*(){if(!r.value.subject||!r.value.description||!r.value.tender){p("Please fill in all fields.",{type:"warning"});return}j.value=!0;try{const n=yield v.secureFetch("/api/method/supplier_portal.api.create_rfq_query",{method:"POST",body:JSON.stringify({subject:r.value.subject,rfq:r.value.tender,query:r.value.description})});if(n.ok){const t=yield n.json();p("Query submitted successfully",{type:"success"}),A(),r.value={subject:"",tender:"",description:""},V()}else{const t=yield n.json();console.error("Submission failed:",t),p(t.message||"Submission failed",{type:"danger"})}}catch(n){console.error("Network error:",n),p("Network error occurred. Please try again.",{type:"danger"})}finally{j.value=!1}}),q=g(!1),K=()=>M(this,null,function*(){if(!d.value.tender||!d.value.type||!d.value.reason){p("Please fill in all fields.",{type:"warning"});return}q.value=!0;try{const n=yield v.secureFetch("/api/method/supplier_portal.api.create_rfq_questionnaire",{method:"POST",body:JSON.stringify({rfq:d.value.tender,subject:d.value.type,query:d.value.reason})});if(n.ok)p("Questionnaire requested successfully",{type:"success"}),F(),d.value={tender:"",type:"",reason:""},V();else{const t=yield n.json();p(t.message||"Request failed",{type:"danger"})}}catch(n){console.error("Network error:",n),p("Network error occurred.",{type:"danger"})}finally{q.value=!1}}),W=U(()=>{const n=b.value.filter(c=>c.type==="Query").length,t=b.value.filter(c=>c.type==="Query"&&c.status==="Pending").length,s=b.value.filter(c=>c.type==="Query"&&c.status==="Answered").length,w=b.value.filter(c=>c.type==="Questionnaire").length;return[{name:"Total Queries",value:n.toString(),icon:O,color:"text-blue-600",bg:"bg-blue-50"},{name:"Pending",value:t.toString(),icon:J,color:"text-orange-600",bg:"bg-orange-50"},{name:"Answered",value:s.toString(),icon:E,color:"text-green-600",bg:"bg-green-50"},{name:"Questionnaires",value:w.toString(),icon:ae,color:"text-indigo-600",bg:"bg-indigo-50"}]}),B=U(()=>{const n=y.value==="My Queries"?"Query":"Questionnaire";return b.value.filter(t=>{var s,w;return t.type===n&&(((s=t.title)==null?void 0:s.toLowerCase().includes(x.value.toLowerCase()))||((w=t.ref)==null?void 0:w.toLowerCase().includes(x.value.toLowerCase())))})}),Z=()=>u.value=!0,A=()=>{u.value=!1,r.value={tender:"",subject:"",description:""}},ee=()=>T.value=!0,F=()=>T.value=!1;return oe(()=>{V(),$()}),(n,t)=>(o(),i("div",ue,[e("div",ce,[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-3xl font-bold tracking-tight text-gray-900"},"Queries & Questionnaires"),e("p",{class:"mt-1 text-sm text-gray-500"},"Submit queries about tenders and respond to questionnaires.")],-1)),e("div",ge,[e("button",{onClick:ee,class:"inline-flex items-center gap-2 rounded-md bg-white px-4 py-2 text-sm font-semibold text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},[f(m(ne),{class:"h-4 w-4"}),t[7]||(t[7]=R(" Request Questionnaire ",-1))]),e("button",{onClick:Z,class:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"},[f(m(re),{class:"h-4 w-4"}),t[8]||(t[8]=R(" New Query ",-1))])])]),e("div",me,[(o(!0),i(Q,null,C(W.value,s=>(o(),i("div",{key:s.name,class:"rounded-lg bg-white px-4 py-5 shadow sm:p-6 border border-gray-100 flex items-center gap-4"},[e("div",{class:D([s.bg,"rounded-md p-3"])},[(o(),I(ie(s.icon),{class:D([s.color,"h-6 w-6"])},null,8,["class"]))],2),e("div",null,[e("dt",pe,a(s.name),1),e("dd",ye,a(s.value),1)])]))),128))]),e("div",be,[e("div",fe,[(o(),i(Q,null,C(L,s=>e("button",{key:s,onClick:w=>y.value=s,class:D([y.value===s?"bg-gray-100 text-gray-900 font-semibold":"text-gray-500 hover:text-gray-700 hover:bg-gray-50","rounded-md px-3 py-2 text-sm font-medium transition-colors"])},a(s),11,ve)),64))])]),e("div",xe,[e("div",he,[e("div",we,[f(m(le),{class:"h-4 w-4 text-gray-400"})]),_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>x.value=s),type:"text",class:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 shadow-sm",placeholder:"Search queries..."},null,512),[[N,x.value]])]),S.value?(o(),i("div",ke,[...t[10]||(t[10]=[e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-indigo-600"},null,-1)])])):k("",!0)]),S.value?k("",!0):(o(),i("div",_e,[B.value.length===0?(o(),i("div",Se,[f(m(O),{class:"mx-auto h-12 w-12 text-gray-400"}),t[11]||(t[11]=e("h3",{class:"mt-2 text-sm font-semibold text-gray-900"},"No records found",-1)),t[12]||(t[12]=e("p",{class:"mt-1 text-sm text-gray-500"},"Submit a new query to see it listed here.",-1))])):k("",!0),(o(!0),i(Q,null,C(B.value,s=>(o(),i("div",{key:s.id,class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-shadow"},[e("div",Qe,[e("div",Ce,[s.status==="Answered"?(o(),i("div",je,[f(m(E),{class:"h-5 w-5 text-green-600"})])):(o(),i("div",qe,[f(m(J),{class:"h-5 w-5 text-orange-600"})]))]),e("div",Me,[e("div",Re,[e("div",Ne,[e("h3",De,a(s.title),1),e("span",{class:D(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset",s.status==="Answered"||s.status==="Completed"?"bg-green-50 text-green-700 ring-green-600/20":s.status==="Action Required"?"bg-indigo-50 text-indigo-700 ring-indigo-600/20":"bg-orange-50 text-orange-700 ring-orange-600/20"])},a(s.status),3)]),e("div",Le,a(s.id),1)]),e("p",Te,a(s.ref),1),e("div",Ve,a(s.question),1),s.response?(o(),i("div",Ae,[e("div",Fe,[t[13]||(t[13]=e("span",null,"Response",-1)),e("span",Pe,a(s.responseDate),1)]),e("div",{class:"text-green-900 prose prose-sm max-w-none",innerHTML:s.response},null,8,ze)])):k("",!0),e("p",Be,"Submitted: "+a(s.submitted),1)])])]))),128))])),u.value?(o(),i("div",Ue,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:A}),e("div",Oe,[e("div",He,[e("button",{type:"button",class:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",onClick:A},[t[14]||(t[14]=e("span",{class:"sr-only"},"Close",-1)),f(m(H),{class:"h-5 w-5","aria-hidden":"true"})])]),e("div",null,[t[20]||(t[20]=e("h3",{class:"text-lg font-bold leading-6 text-gray-900 mb-6",id:"modal-title"},"Submit New Query",-1)),e("div",Ie,[e("div",null,[t[16]||(t[16]=e("label",{for:"tender",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Select Tender",-1)),_(e("select",{id:"tender","onUpdate:modelValue":t[1]||(t[1]=s=>r.value.tender=s),class:"block w-full rounded-lg border-0 py-2.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[t[15]||(t[15]=e("option",{value:"",disabled:"",selected:""},"Select tender",-1)),(o(!0),i(Q,null,C(h.value,s=>(o(),i("option",{key:s,value:s},a(s),9,Je))),128))],512),[[P,r.value.tender]])]),e("div",null,[t[17]||(t[17]=e("label",{for:"subject",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Subject",-1)),_(e("input",{type:"text",id:"subject","onUpdate:modelValue":t[2]||(t[2]=s=>r.value.subject=s),placeholder:"Brief subject of your query",class:"block w-full rounded-lg border-0 py-2.5 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,512),[[N,r.value.subject]])]),e("div",null,[t[18]||(t[18]=e("label",{for:"query",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Your Query",-1)),_(e("textarea",{id:"query",rows:"4","onUpdate:modelValue":t[3]||(t[3]=s=>r.value.description=s),placeholder:"Describe your query in detail...",class:"block w-full rounded-lg border-0 py-2.5 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,512),[[N,r.value.description]])])]),e("div",Ee,[e("button",{onClick:G,disabled:j.value,type:"button",class:"inline-flex w-full justify-center rounded-lg bg-indigo-600 px-3 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 gap-2 items-center transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[j.value?(o(),i("svg",Ye,[...t[19]||(t[19]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(o(),I(m(de),{key:1,class:"h-4 w-4"})),R(" "+a(j.value?"Submitting...":"Submit Query"),1)],8,Xe)])])])])):k("",!0),T.value?(o(),i("div",$e,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:F}),e("div",Ge,[e("div",Ke,[e("button",{type:"button",class:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",onClick:F},[t[21]||(t[21]=e("span",{class:"sr-only"},"Close",-1)),f(m(H),{class:"h-5 w-5","aria-hidden":"true"})])]),e("div",null,[t[28]||(t[28]=e("h3",{class:"text-lg font-bold leading-6 text-gray-900 mb-6",id:"modal-title"},"Request Questionnaire",-1)),e("div",We,[e("div",null,[t[23]||(t[23]=e("label",{for:"req-tender",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Select Tender",-1)),_(e("select",{id:"req-tender","onUpdate:modelValue":t[4]||(t[4]=s=>d.value.tender=s),class:"block w-full rounded-lg border-0 py-2.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[t[22]||(t[22]=e("option",{value:"",disabled:"",selected:""},"Select tender",-1)),(o(!0),i(Q,null,C(h.value,s=>(o(),i("option",{key:s,value:s},a(s),9,Ze))),128))],512),[[P,d.value.tender]])]),e("div",null,[t[25]||(t[25]=e("label",{for:"req-type",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Type of Questionnaire",-1)),_(e("select",{id:"req-type","onUpdate:modelValue":t[5]||(t[5]=s=>d.value.type=s),class:"block w-full rounded-lg border-0 py-2.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[t[24]||(t[24]=e("option",{value:"",disabled:"",selected:""},"Select type",-1)),(o(),i(Q,null,C(Y,s=>e("option",{key:s,value:s},a(s),9,et)),64))],512),[[P,d.value.type]])]),e("div",null,[t[26]||(t[26]=e("label",{for:"req-reason",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Reason for Request",-1)),_(e("textarea",{id:"req-reason",rows:"4","onUpdate:modelValue":t[6]||(t[6]=s=>d.value.reason=s),placeholder:"Explain why you need this questionnaire...",class:"block w-full rounded-lg border-0 py-2.5 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,512),[[N,d.value.reason]])])]),e("div",tt,[e("button",{onClick:K,disabled:q.value,type:"button",class:"inline-flex w-full justify-center rounded-lg bg-indigo-600 px-3 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 gap-2 items-center transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[q.value?(o(),i("svg",ot,[...t[27]||(t[27]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):k("",!0),R(" "+a(q.value?"Submitting...":"Submit Request"),1)],8,st)])])])])):k("",!0)]))}};export{gt as default};
//# sourceMappingURL=Queries-Dn2AMQQE.js.map
