var _=(N,v,h)=>new Promise((f,p)=>{var g=l=>{try{x(h.next(l))}catch(a){p(a)}},C=l=>{try{x(h.throw(l))}catch(a){p(a)}},x=l=>l.done?f(l.value):Promise.resolve(l.value).then(g,C);x((h=h.apply(N,v)).next())});import{m as y,p as J,y as A,P as k,a as n,b as e,k as S,e as d,f as b,u as c,F as j,r as M,q as u,v as m,t as r,X as K,C as Q,o as i,n as U,h as z,i as I}from"./index-DCPhcw9F.js";import{C as G}from"./circle-check-big-Ds9vdK09.js";import{C as H}from"./clock-RuiGBjmH.js";import{T as q}from"./trending-up-C6GyfudO.js";import{P as E}from"./plus-BCfR94nn.js";import{S as R}from"./search-CJJiFWfM.js";import{F as X}from"./funnel-CG9e7oJk.js";import{P as W}from"./pen-DGUv9OzG.js";import{T as Y}from"./trash-2-DqMGaKuc.js";const Z={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8"},ee={class:"flex items-center justify-between mb-8"},te={class:"grid grid-cols-1 gap-4 sm:grid-cols-4 mb-8"},se={class:"truncate text-sm font-medium text-gray-500"},oe={class:"mt-1 text-2xl font-semibold tracking-tight text-gray-900"},ae={class:"mb-6"},re={class:"flex space-x-2"},le=["onClick"],ie={class:"flex flex-col sm:flex-row gap-4 mb-6"},ne={class:"relative flex-grow"},de={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},ce={class:"inline-flex items-center justify-center gap-2 rounded-md bg-white px-4 py-2 text-sm font-semibold text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},ue={key:0,class:"flex flex-col items-center justify-center py-20 bg-white rounded-xl border border-gray-200"},ge={key:1,class:"space-y-4"},me={key:0,class:"text-center py-20 bg-white rounded-xl border-2 border-dashed border-gray-200"},pe={key:0,class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-shadow"},xe={class:"flex flex-col lg:flex-row gap-6"},ye={class:"flex-shrink-0"},fe={class:"h-16 w-16 rounded-lg bg-gray-50 flex items-center justify-center border border-gray-100"},be={class:"flex-grow"},ve={class:"flex flex-wrap items-center gap-2 mb-1"},he={class:"text-lg font-bold text-gray-900"},we={class:"inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset bg-green-50 text-green-700 ring-green-600/20"},_e={key:0,class:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-2 py-0.5 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10"},ke={class:"text-sm text-gray-500 mb-2"},Ce={class:"text-sm text-gray-600 leading-relaxed"},Pe={class:"flex lg:flex-col items-center lg:items-end justify-between lg:justify-center gap-1 min-w-[180px] border-t lg:border-t-0 lg:border-l border-gray-100 pt-4 lg:pt-0 lg:pl-8"},Te={class:"text-right"},Se={class:"text-2xl font-bold text-gray-900"},je={class:"text-xs text-gray-400 font-medium"},Me={class:"lg:mt-4 text-right text-sm text-gray-500 leading-tight"},Ue={class:"flex justify-end gap-1"},Ne={class:"font-medium text-gray-700"},Ve={class:"flex justify-end gap-1"},Ae={class:"font-medium text-gray-700"},qe={class:"flex gap-2 mt-4"},Ee=["onClick"],Fe=["onClick"],Oe={key:1,class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm flex items-center gap-4 hover:border-indigo-200 transition-colors"},Le={class:"h-12 w-12 rounded bg-gray-50 flex items-center justify-center flex-shrink-0"},Be={class:"flex-grow"},De={class:"text-sm font-bold text-gray-900"},$e={class:"text-xs text-gray-500"},Je=["onClick"],Ke={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"},Qe={class:"w-full max-w-2xl rounded-xl bg-white shadow-2xl overflow-hidden"},ze={class:"flex items-center justify-between border-b border-gray-100 px-6 py-4"},Ie={class:"text-lg font-bold text-gray-900"},Ge={class:"p-6 max-h-[80vh] overflow-y-auto"},He={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Re={class:"col-span-1"},Xe={class:"col-span-1"},We={class:"col-span-1"},Ye={class:"col-span-1"},Ze={class:"col-span-1"},et={class:"col-span-1"},tt={class:"col-span-1"},st={class:"col-span-1"},ot={class:"col-span-2"},at={class:"bg-gray-50 px-6 py-4 flex justify-end gap-3"},xt={__name:"Catalog",setup(N){const v=y("My Catalog"),h=["My Catalog","Portal Items"],f=y(""),p=y(!0),g=y([]),C=y(""),x=y(!1),l=y(!1),a=y({id:"",name:"",sku:"",category:"",unit:"",price:0,tax:"",moq:"",leadTime:"",description:""}),F=o=>{l.value=!0,a.value={id:o.id,name:o.name,sku:o.sku,category:o.category,unit:o.unit||"Nos",price:o.price,tax:o.tax,moq:o.min_order_qty||1,leadTime:item.lead_time_days||"N/A",description:o.description},x.value=!0},P=()=>_(this,null,function*(){p.value=!0;try{const o=yield fetch("/api/method/supplier_portal.api.get_catalog_items");if(!o.ok)throw new Error("Network response was not ok");const t=yield o.json();t&&t.message&&(g.value=t.message.items||[],C.value=t.message.current_supplier||"")}catch(o){console.error("Failed to load products:",o)}finally{p.value=!1}});J(()=>{P()});const V=A(()=>g.value?g.value.filter(o=>{var s,w;return!f.value||((s=o.name)==null?void 0:s.toLowerCase().includes(f.value.toLowerCase()))||((w=o.sku)==null?void 0:w.toLowerCase().includes(f.value.toLowerCase()))?v.value==="My Catalog"?o.is_my_item===!0:o.is_purchase_item==1&&o.is_my_item===!1:!1}):[]),O=()=>{l.value=!1,a.value={id:"",name:"",sku:"",category:"",unit:"",price:0,tax:"",moq:"",leadTime:"",description:""},x.value=!0},T=()=>{x.value=!1},L=()=>_(this,null,function*(){if(!a.value.name){alert("Please enter a product name");return}try{p.value=!0;const o=l.value?"/api/method/supplier_portal.api.update_supplier_item":"/api/method/supplier_portal.api.create_supplier_item",s=yield(yield fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a.value)})).json();s.message==="success"?(T(),yield P(),alert(l.value?"Product updated successfully!":"Product added successfully!")):alert("Error: "+(s.message||"Failed to save product"))}catch(o){console.error("Submission failed:",o),alert("An error occurred while saving the product.")}finally{p.value=!1}}),B=o=>_(this,null,function*(){try{(yield(yield fetch("/api/method/supplier_portal.api.add_to_catalog",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_id:o.id})})).json()).message==="success"&&(o.is_my_item=!0,alert(`${o.name} added to your catalog!`))}catch(t){console.error("Failed to add item:",t)}}),D=o=>_(this,null,function*(){if(confirm("Are you sure you want to remove this item?"))try{(yield(yield fetch("/api/method/supplier_portal.api.remove_from_catalog",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_id:o})})).json()).message==="success"&&(yield P())}catch(t){console.error("Delete request failed:",t)}}),$=A(()=>[{name:"Total Products",value:g.value.filter(o=>o.is_my_item).length,icon:k,color:"text-indigo-600",bg:"bg-indigo-50"},{name:"Active Items",value:g.value.filter(o=>o.is_my_item&&o.status==="active").length,icon:G,color:"text-green-600",bg:"bg-green-50"},{name:"Pending Approval",value:g.value.filter(o=>o.is_my_item&&o.status==="pending").length,icon:H,color:"text-orange-600",bg:"bg-orange-50"},{name:"Matched Tenders",value:g.value.reduce((o,t)=>t.is_my_item?o+(t.matches||0):o,0),icon:q,color:"text-blue-600",bg:"bg-blue-50"}]);return(o,t)=>(i(),n("div",Z,[e("div",ee,[t[11]||(t[11]=e("div",null,[e("h1",{class:"text-3xl font-bold tracking-tight text-gray-900"},"Product Catalog"),e("p",{class:"mt-1 text-sm text-gray-500"},"Manage your product catalog and pricing.")],-1)),e("button",{onClick:O,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 flex items-center gap-2"},[d(c(E),{class:"h-4 w-4"}),t[10]||(t[10]=b(" Add Product ",-1))])]),e("div",te,[(i(!0),n(j,null,M($.value,s=>(i(),n("div",{key:s.name,class:"rounded-lg bg-white px-4 py-5 shadow sm:p-6 border border-gray-100 flex items-center gap-4"},[e("div",{class:U([s.bg,"rounded-md p-3"])},[(i(),z(I(s.icon),{class:U([s.color,"h-6 w-6"])},null,8,["class"]))],2),e("div",null,[e("dt",se,r(s.name),1),e("dd",oe,r(s.value),1)])]))),128))]),e("div",ae,[e("div",re,[(i(),n(j,null,M(h,s=>e("button",{key:s,onClick:w=>v.value=s,class:U([v.value===s?"bg-indigo-50 text-indigo-700 ring-1 ring-inset ring-indigo-700/10 font-semibold":"text-gray-500 hover:text-gray-700 hover:bg-gray-50","rounded-md px-4 py-2 text-sm font-medium transition-colors"])},r(s),11,le)),64))])]),e("div",ie,[e("div",ne,[e("div",de,[d(c(R),{class:"h-4 w-4 text-gray-400"})]),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>f.value=s),type:"text",class:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 shadow-sm",placeholder:"Search products..."},null,512),[[m,f.value]])]),e("button",ce,[d(c(X),{class:"h-4 w-4 text-gray-500"}),t[12]||(t[12]=b(" Filters ",-1))])]),p.value?(i(),n("div",ue,[...t[13]||(t[13]=[e("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mb-4"},null,-1),e("p",{class:"text-gray-500"},"Fetching products...",-1)])])):(i(),n("div",ge,[V.value.length===0?(i(),n("div",me,[d(c(k),{class:"mx-auto h-12 w-12 text-gray-300 mb-4"}),t[14]||(t[14]=e("h3",{class:"text-sm font-semibold text-gray-900"},"No products found",-1)),t[15]||(t[15]=e("p",{class:"mt-1 text-sm text-gray-500"},"Try adjusting your search or filters.",-1))])):S("",!0),(i(!0),n(j,null,M(V.value,s=>(i(),n("div",{key:s.id},[v.value==="My Catalog"?(i(),n("div",pe,[e("div",xe,[e("div",ye,[e("div",fe,[d(c(k),{class:"h-8 w-8 text-gray-400"})])]),e("div",be,[e("div",ve,[e("h3",he,r(s.name),1),e("span",we,r(s.status),1),s.matches?(i(),n("span",_e,[d(c(q),{class:"h-3 w-3"}),b(" "+r(s.matches)+" matches ",1)])):S("",!0)]),e("div",ke,[t[16]||(t[16]=e("span",{class:"font-bold text-gray-700"},"SKU:",-1)),b(" "+r(s.sku||"N/A")+" ",1),t[17]||(t[17]=e("span",{class:"mx-2 text-gray-300"},"•",-1)),t[18]||(t[18]=e("span",{class:"font-bold text-gray-700"},"Category:",-1)),b(" "+r(s.category)+" ",1),t[19]||(t[19]=e("span",{class:"mx-2 text-gray-300"},"•",-1)),t[20]||(t[20]=e("span",{class:"font-bold text-gray-700"},"Unit:",-1)),b(" "+r(s.unit||"Nos"),1)]),e("p",Ce,r(s.description),1)]),e("div",Pe,[e("div",Te,[e("div",Se,"₹"+r(Number(s.price).toLocaleString()),1),e("div",je,"+ "+r(s.tax),1)]),e("div",Me,[e("div",Ue,[t[21]||(t[21]=e("span",{class:"text-gray-400"},"Lead:",-1)),e("span",Ne,r(s.leadTime),1)]),e("div",Ve,[t[22]||(t[22]=e("span",{class:"text-gray-400"},"MOQ:",-1)),e("span",Ae,r(s.moq),1)])]),e("div",qe,[e("button",{onClick:w=>F(s),class:"p-2 text-gray-400 hover:text-indigo-600 rounded-md hover:bg-gray-50 transition-colors"},[d(c(W),{class:"h-4 w-4"})],8,Ee),e("button",{onClick:w=>D(s.id),class:"p-2 text-gray-400 hover:text-red-600 rounded-md hover:bg-gray-50 transition-colors"},[d(c(Y),{class:"h-4 w-4"})],8,Fe)])])])])):(i(),n("div",Oe,[e("div",Le,[d(c(k),{class:"h-6 w-6 text-gray-400"})]),e("div",Be,[e("h3",De,r(s.name),1),e("p",$e,"Category: "+r(s.category)+" • Unit: "+r(s.unit),1)]),e("button",{onClick:w=>B(s),class:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md text-sm font-semibold text-gray-700 hover:bg-gray-50 transition whitespace-nowrap"},[d(c(E),{class:"h-4 w-4"}),t[23]||(t[23]=b(" Add to My Catalog ",-1))],8,Je)]))]))),128))])),x.value?(i(),n("div",Ke,[e("div",Qe,[e("div",ze,[e("h3",Ie,r(l.value?"Edit Product":"Add New Product"),1),e("button",{onClick:T,class:"text-gray-400 hover:text-gray-500"},[d(c(K),{class:"h-5 w-5"})])]),e("div",Ge,[e("div",He,[e("div",Re,[t[24]||(t[24]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Product Name",-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.name=s),type:"text",placeholder:"Enter product name",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.name]])]),e("div",Xe,[t[25]||(t[25]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"SKU",-1)),u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.sku=s),type:"text",placeholder:"Enter SKU",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.sku]])]),e("div",We,[t[26]||(t[26]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Category",-1)),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.category=s),type:"text",placeholder:"e.g. Hardware",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.category]])]),e("div",Ye,[t[27]||(t[27]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Unit of Measure",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.unit=s),type:"text",placeholder:"e.g. Nos",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.unit]])]),e("div",Ze,[t[28]||(t[28]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Base Price (₹)",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.price=s),type:"number",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.price]])]),e("div",et,[t[30]||(t[30]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"GST Rate (%)",-1)),u(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.tax=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[...t[29]||(t[29]=[e("option",{value:"18%"},"18%",-1),e("option",{value:"12%"},"12%",-1),e("option",{value:"5%"},"5%",-1)])],512),[[Q,a.value.tax]])]),e("div",tt,[t[31]||(t[31]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"MOQ",-1)),u(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.moq=s),type:"number",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.moq]])]),e("div",st,[t[32]||(t[32]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Lead Time (Days)",-1)),u(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.leadTime=s),type:"text",placeholder:"Delivery lead time",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.leadTime]])]),e("div",ot,[t[33]||(t[33]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Specifications",-1)),u(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=s=>a.value.description=s),rows:"3",placeholder:"Enter product specifications...",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.description]])])])]),e("div",at,[e("button",{onClick:T,class:"px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-100 rounded-md"},"Cancel"),e("button",{onClick:L,class:"px-6 py-2 bg-indigo-600 text-sm font-semibold text-white rounded-md hover:bg-indigo-500 shadow-sm"},r(l.value?"Update Catalog":"Add to Catalog"),1)])])])):S("",!0)]))}};export{xt as default};
//# sourceMappingURL=Catalog-D6WkbZNo.js.map
