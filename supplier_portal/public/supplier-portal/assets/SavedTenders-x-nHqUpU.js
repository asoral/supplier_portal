var P=Object.defineProperty,U=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var $=(c,a,o)=>a in c?P(c,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):c[a]=o,T=(c,a)=>{for(var o in a||(a={}))H.call(a,o)&&$(c,o,a[o]);if(V)for(var o of V(a))J.call(a,o)&&$(c,o,a[o]);return c},B=(c,a)=>U(c,z(a));var _=(c,a,o)=>new Promise((f,C)=>{var b=p=>{try{m(o.next(p))}catch(h){C(h)}},w=p=>{try{m(o.throw(p))}catch(h){C(h)}},m=p=>p.done?f(p.value):Promise.resolve(p.value).then(b,w);m((o=o.apply(c,a)).next())});import{m as k,B as S,A as Q,y as W,p as I,a as g,b as e,e as v,f as y,u as i,t as l,g as K,F as R,r as D,q as Y,v as Z,o as d,n as A,h as ee,i as te,k as se}from"./index-CSQFqbOH.js";import{t as oe}from"./mosha-vue-toastify.es-CUpUU8SK.js";/* empty css              */import{C as L}from"./clock-DBnEg0y0.js";import{A as ae}from"./arrow-right-Oy7WMhXA.js";import{S as q}from"./search-D1GfWk-E.js";import{T as ne}from"./trash-2-CAAsPIFa.js";import{E as re}from"./eye-DmDEiTcF.js";const ie={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8"},le={class:"flex items-center justify-between mb-8"},de={class:"text-3xl font-bold tracking-tight text-gray-900 flex items-center gap-2"},ce={class:"mt-1 text-sm text-gray-500"},ue={class:"grid grid-cols-1 gap-4 sm:grid-cols-4 mb-8"},ge={class:"truncate text-sm font-medium text-gray-500"},me={class:"mt-1 text-2xl font-semibold tracking-tight text-gray-900"},pe={class:"flex flex-col sm:flex-row gap-4 mb-6 items-center"},ve={class:"relative flex-grow w-full sm:w-auto"},xe={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},fe={class:"flex space-x-2 bg-gray-100 p-1 rounded-lg"},he=["onClick"],ye={key:0,class:"text-center py-12"},be={key:1,class:"text-center py-12 bg-white rounded-xl border-2 border-dashed border-gray-200"},we={class:"mt-6"},_e={key:2,class:"space-y-4"},ke={class:"flex flex-col sm:flex-row justify-between gap-4"},Ce={class:"flex-grow"},Te={class:"flex items-center gap-2 mb-1"},Se=["onClick"],Ae={class:"text-sm text-gray-500 mb-3"},Fe={class:"flex flex-wrap gap-x-6 gap-y-2 text-sm text-gray-600"},Be={class:"flex items-center gap-1 font-semibold text-gray-900"},Re={class:"flex items-center gap-1"},De={key:0,class:"text-red-600 text-xs font-medium flex items-center px-2 py-0.5 bg-red-50 rounded"},Le={class:"text-xs text-gray-400 mt-3 font-medium"},Ne={class:"flex items-center gap-3 self-start sm:self-center"},je={class:"p-2 bg-indigo-50 rounded-md",title:"Tender is saved"},Oe=["onClick"],Ve=["onClick"],$e=["onClick"],Qe={__name:"SavedTenders",setup(c){const a=K(),o=k([]),f=k("All"),C=["All","Active","Closed"],b=k(""),w=k(!0),m=k([{name:"Total Saved",value:"0",icon:S,color:"text-indigo-600",bg:"bg-indigo-50"},{name:"Active",value:"0",icon:L,color:"text-green-600",bg:"bg-green-50"},{name:"Closing Soon",value:"0",icon:L,color:"text-orange-600",bg:"bg-orange-50"},{name:"Alerts On",value:"0",icon:Q,color:"text-blue-600",bg:"bg-blue-50"}]),p=()=>{o.value&&(m.value[0].value=o.value.length.toString(),m.value[1].value=o.value.filter(n=>n.status==="Active").length.toString(),m.value[2].value=o.value.filter(n=>n.status==="Active").length.toString(),m.value[3].value="0")},h=()=>_(this,null,function*(){try{const t=yield(yield fetch("/api/method/supplier_portal.api.get_csrf_token",{credentials:"include",cache:"no-store"})).json();if(t.message)return window.csrf_token=t.message,t.message}catch(n){console.error("Failed to refresh CSRF token",n)}return window.csrf_token}),E=(s,...r)=>_(this,[s,...r],function*(n,t={}){let u=window.csrf_token;(!u||u==="None")&&(u=yield h());const F=T({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-Frappe-CSRF-Token":u},t.headers||{}),O=B(T({},t),{headers:F,credentials:"include"});let x=yield fetch(n,O);if(!x.ok)try{((yield x.clone().json()).exc_type==="CSRFTokenError"||x.status===403||x.status===417||x.status===400)&&(yield new Promise(G=>setTimeout(G,500)),u=yield h(),F["X-Frappe-CSRF-Token"]=u,x=yield fetch(n,B(T({},O),{headers:F})))}catch(M){}return x}),N=()=>_(this,null,function*(){w.value=!0;try{const s=(yield(yield fetch("/api/method/supplier_portal.api.get_saved_tenders",{method:"GET",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":window.csrf_token||""}})).json()).message||[];o.value=s.map(r=>({saved_id:r.saved_id,id:r.rfq_id||r.rfq||r.id,title:r.title||"Untitled Tender",status:r.status||"Active",category:r.category||"General",value:r.value||r.total_budget||0,deadline:r.deadline||"N/A",deadlineStatus:r.deadlineStatus,savedOn:r.savedOn||"Recently",liveBidding:r.liveBidding})),p()}catch(n){console.error("Fetch failed:",n)}finally{w.value=!1}}),X=n=>_(this,null,function*(){if(n&&confirm("Remove this tender from your saved list?"))try{(yield E("/api/method/supplier_portal.api.delete_saved_tender",{method:"POST",body:JSON.stringify({saved_id:n})})).ok&&(oe("Tender removed",{type:"success"}),yield N())}catch(t){console.error("Delete error:",t)}}),j=W(()=>{const n=(b.value||"").toLowerCase();return(o.value||[]).filter(t=>{const r=(t.title||"").toLowerCase().includes(n)||t.id.toLowerCase().includes(n),u=f.value==="All"||t.status===f.value;return r&&u})});return I(()=>{N()}),(n,t)=>(d(),g("div",ie,[e("div",le,[e("div",null,[e("h1",de,[v(i(S),{class:"h-8 w-8 text-indigo-600 fill-indigo-600"}),t[3]||(t[3]=y(" Saved Tenders ",-1))]),e("p",ce,l(m.value[0].value)+" tenders saved • "+l(m.value[1].value)+" active ",1)]),e("button",{class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 flex items-center gap-2 transition-colors",onClick:t[0]||(t[0]=s=>i(a).push("/tenders"))},[t[4]||(t[4]=y(" Browse More Tenders ",-1)),v(i(ae),{class:"h-4 w-4"})])]),e("div",ue,[(d(!0),g(R,null,D(m.value,s=>(d(),g("div",{key:s.name,class:"overflow-hidden rounded-lg bg-white px-4 py-5 shadow-sm border border-gray-100 flex items-center gap-4"},[e("div",{class:A([s.bg,"rounded-md p-3"])},[(d(),ee(te(s.icon),{class:A([s.color,"h-6 w-6"])},null,8,["class"]))],2),e("div",null,[e("dt",ge,l(s.name),1),e("dd",me,l(s.value),1)])]))),128))]),e("div",pe,[e("div",ve,[e("div",xe,[v(i(q),{class:"h-4 w-4 text-gray-400"})]),Y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>b.value=s),type:"text",class:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",placeholder:"Search saved tenders..."},null,512),[[Z,b.value]])]),e("div",fe,[(d(),g(R,null,D(C,s=>e("button",{key:s,onClick:r=>f.value=s,class:A([f.value===s?"bg-white text-gray-900 shadow":"text-gray-500 hover:text-gray-900","rounded-md px-3 py-1.5 text-sm font-medium transition-all"])},l(s),11,he)),64))])]),w.value?(d(),g("div",ye,[...t[5]||(t[5]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-500 font-medium"},"Loading saved tenders...",-1)])])):j.value.length===0?(d(),g("div",be,[v(i(S),{class:"mx-auto h-12 w-12 text-gray-300"}),t[7]||(t[7]=e("h3",{class:"mt-2 text-sm font-semibold text-gray-900"},"No saved tenders found",-1)),t[8]||(t[8]=e("p",{class:"mt-1 text-sm text-gray-500"},"Try adjusting your search or browse new tenders.",-1)),e("div",we,[e("button",{onClick:t[2]||(t[2]=s=>i(a).push("/tenders")),class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"},[v(i(q),{class:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),t[6]||(t[6]=y(" Find Tenders ",-1))])])])):(d(),g("div",_e,[(d(!0),g(R,null,D(j.value,s=>{var r;return d(),g("div",{key:s.id,class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-all"},[e("div",ke,[e("div",Ce,[e("div",Te,[e("h3",{class:"text-base font-semibold text-gray-900 hover:text-indigo-600 cursor-pointer",onClick:u=>i(a).push({name:"TenderDetail",params:{id:s.id}})},l(s.title),9,Se),e("span",{class:A(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset",s.status==="Active"?"bg-blue-50 text-blue-700 ring-blue-700/10":s.status==="Closing Soon"?"bg-orange-50 text-orange-700 ring-orange-600/20":"bg-gray-50 text-gray-600 ring-gray-500/10"])},l(s.status),3)]),e("p",Ae,l(s.id)+" • "+l(s.category),1),e("div",Fe,[e("span",Be," ₹"+l(((r=s.value)==null?void 0:r.toLocaleString("en-IN"))||"0"),1),e("span",Re,[v(i(L),{class:"h-4 w-4 text-gray-400"}),y(" "+l(s.deadline),1)]),s.deadlineStatus?(d(),g("span",De,l(s.deadlineStatus),1)):se("",!0)]),e("p",Le,"Saved on "+l(s.savedOn),1)]),e("div",Ne,[e("div",je,[v(i(S),{class:"h-4 w-4 text-indigo-600 fill-indigo-600"})]),e("button",{onClick:u=>X(s.saved_id),class:"p-2 text-gray-400 hover:text-red-600 bg-gray-50 rounded-md hover:bg-red-50 transition-colors",title:"Remove from Saved"},[v(i(ne),{class:"h-4 w-4"})],8,Oe),s.liveBidding?(d(),g("button",{key:0,onClick:u=>i(a).push({name:"TenderDetail",params:{id:s.id}}),class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 transition-colors flex items-center gap-1"},[...t[9]||(t[9]=[e("span",{class:"relative flex h-2 w-2 mr-1"},[e("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-orange-400 opacity-75"}),e("span",{class:"relative inline-flex rounded-full h-2 w-2 bg-orange-500"})],-1),y(" View & Bid ",-1)])],8,Ve)):(d(),g("button",{key:1,onClick:u=>i(a).push({name:"TenderDetail",params:{id:s.id}}),class:"inline-flex items-center gap-1 rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},[v(i(re),{class:"h-4 w-4"}),t[10]||(t[10]=y(" View Details ",-1))],8,$e))])])])}),128))]))]))}};export{Qe as default};
//# sourceMappingURL=SavedTenders-x-nHqUpU.js.map
