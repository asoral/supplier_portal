var S=(T,_,y)=>new Promise((x,g)=>{var m=o=>{try{p(y.next(o))}catch(b){g(b)}},Q=o=>{try{p(y.throw(o))}catch(b){g(b)}},p=o=>o.done?x(o.value):Promise.resolve(o.value).then(m,Q);p((y=y.apply(T,_)).next())});import{c as B,m as d,y as P,M as U,p as Y,a as i,b as e,k as h,e as u,f as q,u as c,j as $,F as w,r as k,q as f,v as C,X as A,C as R,o as n,n as j,h as G,i as K,t as a}from"./index-CDJ_LxkQ.js";import{C as D}from"./clock-DFxao2Vg.js";import{C as F}from"./circle-check-big-D1JsNwtu.js";import{P as W}from"./plus-C8Hy-a-f.js";import{S as Z}from"./search-BkChqmeg.js";/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=B("file-question-mark",[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=B("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),se={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8"},oe={class:"flex flex-col md:flex-row md:items-center md:justify-between mb-8 gap-4"},ne={class:"flex gap-3"},ie={class:"grid grid-cols-1 gap-4 sm:grid-cols-4 mb-8"},le={class:"truncate text-sm font-medium text-gray-500"},re={class:"mt-1 text-2xl font-semibold tracking-tight text-gray-900"},ae={class:"mb-6"},de={class:"flex space-x-2"},ue=["onClick"],ce={class:"mb-6 flex items-center justify-between"},ge={class:"relative max-w-sm flex-grow"},me={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},pe={key:0,class:"ml-4"},be={key:0,class:"space-y-4"},fe={key:0,class:"text-center py-12 bg-white rounded-lg border border-dashed border-gray-300"},ye={class:"flex items-start gap-4"},xe={class:"mt-1"},ve={key:0,class:"rounded-full bg-green-100 p-2"},he={key:1,class:"rounded-full bg-orange-100 p-2"},we={class:"flex-grow"},ke={class:"flex justify-between items-start"},_e={class:"flex items-center gap-3 mb-1"},Qe={class:"text-base font-semibold text-gray-900"},Se={class:"text-xs font-mono text-gray-400"},Ce={class:"text-sm text-gray-500 mb-4"},je={class:"bg-gray-50 rounded-lg p-4 mb-3 text-sm text-gray-800 font-medium whitespace-pre-wrap"},Me={key:0,class:"bg-green-50 rounded-lg p-4 text-sm border border-green-100"},qe={class:"text-green-800 font-medium pb-1 mb-1 border-b border-green-200/50 flex justify-between"},Re={class:"text-xs opacity-75"},Te=["innerHTML"],Le={class:"text-xs text-gray-400 mt-2"},Ne={key:1,class:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6",role:"dialog","aria-modal":"true"},Ve={class:"relative transform overflow-hidden rounded-xl bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},Pe={class:"absolute right-0 top-0 hidden pr-4 pt-4 sm:block"},Ue={class:"space-y-4"},Ae=["value"],De={class:"mt-6"},Fe={key:2,class:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6",role:"dialog","aria-modal":"true"},Be={class:"relative transform overflow-hidden rounded-xl bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},Oe={class:"absolute right-0 top-0 hidden pr-4 pt-4 sm:block"},ze={class:"space-y-4"},He=["value"],Je=["value"],Ke={__name:"Queries",setup(T){const _=d("My Queries"),y=["My Queries","Questionnaires"],x=d(""),g=d(!0),m=d([]),Q=d([]),p=d(!1),o=d({tender:"",subject:"",description:""}),b=d(!1),v=d({tender:"",type:"",reason:""}),O=["Compliance Assessment","Technical Assessment"],L=()=>S(this,null,function*(){g.value=!0;try{const s=(yield(yield fetch("/api/resource/RFQ Query?"+new URLSearchParams({fields:JSON.stringify(["name","subject","rfq","query","response","status","creation"]),order_by:"creation desc"}),{credentials:"include"})).json()).data||[];m.value=s.map(l=>({id:l.name,type:"Query",title:l.subject,ref:l.rfq,status:l.status,question:l.query,response:l.response,responseDate:l.response?"Answered":null,submitted:new Date(l.creation).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}))}catch(r){console.error("Failed to fetch queries:",r)}finally{g.value=!1}}),z=()=>S(this,null,function*(){try{const t=yield(yield fetch("/api/resource/Request for Quotation?"+new URLSearchParams({fields:JSON.stringify(["name"]),limit_page_length:50}),{credentials:"include"})).json();Q.value=(t.data||[]).map(s=>s.name)}catch(r){console.error("Failed to fetch tenders:",r)}}),H=()=>S(this,null,function*(){if(!o.value.subject||!o.value.description||!o.value.tender){alert("Please fill in all fields.");return}try{const r=yield fetch("/api/resource/RFQ Query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:o.value.subject,rfq:o.value.tender,query:o.value.description,status:"Pending"}),credentials:"include"});if(r.ok)yield L(),M();else{const t=yield r.json();console.error("Submission failed:",t)}}catch(r){console.error("Network error:",r)}}),J=P(()=>{const r=m.value.length,t=m.value.filter(l=>l.status==="Pending").length,s=m.value.filter(l=>l.status==="Answered").length;return[{name:"Total Queries",value:r.toString(),icon:U,color:"text-blue-600",bg:"bg-blue-50"},{name:"Pending",value:t.toString(),icon:D,color:"text-orange-600",bg:"bg-orange-50"},{name:"Answered",value:s.toString(),icon:F,color:"text-green-600",bg:"bg-green-50"},{name:"Questionnaires",value:"0",icon:ee,color:"text-indigo-600",bg:"bg-indigo-50"}]}),N=P(()=>{const r=_.value==="My Queries"?"Query":"Questionnaire";return m.value.filter(t=>{var s,l;return t.type===r&&(((s=t.title)==null?void 0:s.toLowerCase().includes(x.value.toLowerCase()))||((l=t.ref)==null?void 0:l.toLowerCase().includes(x.value.toLowerCase())))})}),E=()=>p.value=!0,M=()=>{p.value=!1,o.value={tender:"",subject:"",description:""}},I=()=>b.value=!0,V=()=>b.value=!1,X=()=>{};return Y(()=>{L(),z()}),(r,t)=>(n(),i("div",se,[e("div",oe,[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-3xl font-bold tracking-tight text-gray-900"},"Queries & Questionnaires"),e("p",{class:"mt-1 text-sm text-gray-500"},"Submit queries about tenders and respond to questionnaires.")],-1)),e("div",ne,[e("button",{onClick:I,class:"inline-flex items-center gap-2 rounded-md bg-white px-4 py-2 text-sm font-semibold text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},[u(c($),{class:"h-4 w-4"}),t[7]||(t[7]=q(" Request Questionnaire ",-1))]),e("button",{onClick:E,class:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"},[u(c(W),{class:"h-4 w-4"}),t[8]||(t[8]=q(" New Query ",-1))])])]),e("div",ie,[(n(!0),i(w,null,k(J.value,s=>(n(),i("div",{key:s.name,class:"rounded-lg bg-white px-4 py-5 shadow sm:p-6 border border-gray-100 flex items-center gap-4"},[e("div",{class:j([s.bg,"rounded-md p-3"])},[(n(),G(K(s.icon),{class:j([s.color,"h-6 w-6"])},null,8,["class"]))],2),e("div",null,[e("dt",le,a(s.name),1),e("dd",re,a(s.value),1)])]))),128))]),e("div",ae,[e("div",de,[(n(),i(w,null,k(y,s=>e("button",{key:s,onClick:l=>_.value=s,class:j([_.value===s?"bg-gray-100 text-gray-900 font-semibold":"text-gray-500 hover:text-gray-700 hover:bg-gray-50","rounded-md px-3 py-2 text-sm font-medium transition-colors"])},a(s),11,ue)),64))])]),e("div",ce,[e("div",ge,[e("div",me,[u(c(Z),{class:"h-4 w-4 text-gray-400"})]),f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>x.value=s),type:"text",class:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 shadow-sm",placeholder:"Search queries..."},null,512),[[C,x.value]])]),g.value?(n(),i("div",pe,[...t[10]||(t[10]=[e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-indigo-600"},null,-1)])])):h("",!0)]),g.value?h("",!0):(n(),i("div",be,[N.value.length===0?(n(),i("div",fe,[u(c(U),{class:"mx-auto h-12 w-12 text-gray-400"}),t[11]||(t[11]=e("h3",{class:"mt-2 text-sm font-semibold text-gray-900"},"No records found",-1)),t[12]||(t[12]=e("p",{class:"mt-1 text-sm text-gray-500"},"Submit a new query to see it listed here.",-1))])):h("",!0),(n(!0),i(w,null,k(N.value,s=>(n(),i("div",{key:s.id,class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-shadow"},[e("div",ye,[e("div",xe,[s.status==="Answered"?(n(),i("div",ve,[u(c(F),{class:"h-5 w-5 text-green-600"})])):(n(),i("div",he,[u(c(D),{class:"h-5 w-5 text-orange-600"})]))]),e("div",we,[e("div",ke,[e("div",_e,[e("h3",Qe,a(s.title),1),e("span",{class:j(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset",s.status==="Answered"||s.status==="Completed"?"bg-green-50 text-green-700 ring-green-600/20":s.status==="Action Required"?"bg-indigo-50 text-indigo-700 ring-indigo-600/20":"bg-orange-50 text-orange-700 ring-orange-600/20"])},a(s.status),3)]),e("div",Se,a(s.id),1)]),e("p",Ce,a(s.ref),1),e("div",je,a(s.question),1),s.response?(n(),i("div",Me,[e("div",qe,[t[13]||(t[13]=e("span",null,"Response",-1)),e("span",Re,a(s.responseDate),1)]),e("div",{class:"text-green-900 prose prose-sm max-w-none",innerHTML:s.response},null,8,Te)])):h("",!0),e("p",Le,"Submitted: "+a(s.submitted),1)])])]))),128))])),p.value?(n(),i("div",Ne,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:M}),e("div",Ve,[e("div",Pe,[e("button",{type:"button",class:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",onClick:M},[t[14]||(t[14]=e("span",{class:"sr-only"},"Close",-1)),u(c(A),{class:"h-5 w-5","aria-hidden":"true"})])]),e("div",null,[t[20]||(t[20]=e("h3",{class:"text-lg font-bold leading-6 text-gray-900 mb-6",id:"modal-title"},"Submit New Query",-1)),e("div",Ue,[e("div",null,[t[16]||(t[16]=e("label",{for:"tender",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Select Tender",-1)),f(e("select",{id:"tender","onUpdate:modelValue":t[1]||(t[1]=s=>o.value.tender=s),class:"block w-full rounded-lg border-0 py-2.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[t[15]||(t[15]=e("option",{value:"",disabled:"",selected:""},"Select tender",-1)),(n(!0),i(w,null,k(Q.value,s=>(n(),i("option",{key:s,value:s},a(s),9,Ae))),128))],512),[[R,o.value.tender]])]),e("div",null,[t[17]||(t[17]=e("label",{for:"subject",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Subject",-1)),f(e("input",{type:"text",id:"subject","onUpdate:modelValue":t[2]||(t[2]=s=>o.value.subject=s),placeholder:"Brief subject of your query",class:"block w-full rounded-lg border-0 py-2.5 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,512),[[C,o.value.subject]])]),e("div",null,[t[18]||(t[18]=e("label",{for:"query",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Your Query",-1)),f(e("textarea",{id:"query",rows:"4","onUpdate:modelValue":t[3]||(t[3]=s=>o.value.description=s),placeholder:"Describe your query in detail...",class:"block w-full rounded-lg border-0 py-2.5 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,512),[[C,o.value.description]])])]),e("div",De,[e("button",{onClick:H,type:"button",class:"inline-flex w-full justify-center rounded-lg bg-indigo-600 px-3 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 gap-2 items-center transition-all"},[u(c(te),{class:"h-4 w-4"}),t[19]||(t[19]=q(" Submit Query ",-1))])])])])])):h("",!0),b.value?(n(),i("div",Fe,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:V}),e("div",Be,[e("div",Oe,[e("button",{type:"button",class:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",onClick:V},[t[21]||(t[21]=e("span",{class:"sr-only"},"Close",-1)),u(c(A),{class:"h-5 w-5","aria-hidden":"true"})])]),e("div",null,[t[27]||(t[27]=e("h3",{class:"text-lg font-bold leading-6 text-gray-900 mb-6",id:"modal-title"},"Request Questionnaire",-1)),e("div",ze,[e("div",null,[t[23]||(t[23]=e("label",{for:"req-tender",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Select Tender",-1)),f(e("select",{id:"req-tender","onUpdate:modelValue":t[4]||(t[4]=s=>v.value.tender=s),class:"block w-full rounded-lg border-0 py-2.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[t[22]||(t[22]=e("option",{value:"",disabled:"",selected:""},"Select tender",-1)),(n(!0),i(w,null,k(Q.value,s=>(n(),i("option",{key:s,value:s},a(s),9,He))),128))],512),[[R,v.value.tender]])]),e("div",null,[t[25]||(t[25]=e("label",{for:"req-type",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Type of Questionnaire",-1)),f(e("select",{id:"req-type","onUpdate:modelValue":t[5]||(t[5]=s=>v.value.type=s),class:"block w-full rounded-lg border-0 py-2.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[t[24]||(t[24]=e("option",{value:"",disabled:"",selected:""},"Select type",-1)),(n(),i(w,null,k(O,s=>e("option",{key:s,value:s},a(s),9,Je)),64))],512),[[R,v.value.type]])]),e("div",null,[t[26]||(t[26]=e("label",{for:"req-reason",class:"block text-sm font-semibold text-gray-900 mb-1.5"},"Reason for Request",-1)),f(e("textarea",{id:"req-reason",rows:"4","onUpdate:modelValue":t[6]||(t[6]=s=>v.value.reason=s),placeholder:"Explain why you need this questionnaire...",class:"block w-full rounded-lg border-0 py-2.5 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,512),[[C,v.value.reason]])])]),e("div",{class:"mt-6"},[e("button",{onClick:X,type:"button",class:"inline-flex w-full justify-center rounded-lg bg-indigo-600 px-3 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 transition-all"}," Submit Request ")])])])])):h("",!0)]))}};export{Ke as default};
//# sourceMappingURL=Queries-SU9T3Uhe.js.map
