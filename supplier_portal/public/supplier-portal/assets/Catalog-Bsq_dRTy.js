var _=(V,v,h)=>new Promise((y,p)=>{var g=i=>{try{f(h.next(i))}catch(a){p(a)}},P=i=>{try{f(h.throw(i))}catch(a){p(a)}},f=i=>i.done?y(i.value):Promise.resolve(i.value).then(g,P);f((h=h.apply(V,v)).next())});import{m as x,l as K,p as Q,y as E,P as C,a as n,b as e,k as U,F as M,r as N,q as d,e as c,u,v as m,f as w,t as r,X as z,D as I,o as l,n as j,h as G,i as H}from"./index-CRwOK9IK.js";import{C as R}from"./circle-check-big-7hiqCeMg.js";import{C as X}from"./clock-CXK36Yz5.js";import{T as O}from"./trending-up-BDWUryX5.js";import{S as W}from"./search-DyVTcKdV.js";import{F as Y}from"./funnel-B3CMy6rz.js";import{P as Z}from"./pen-gXF_fExc.js";import{T as ee}from"./trash-2-PT0ge1zZ.js";import{P as te}from"./plus-DIvko0qG.js";const se={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8"},oe={class:"grid grid-cols-1 gap-4 sm:grid-cols-4 mb-8"},ae={class:"truncate text-sm font-medium text-gray-500"},re={class:"mt-1 text-2xl font-semibold tracking-tight text-gray-900"},le={class:"mb-6"},ne={class:"flex space-x-2"},ie=["onClick"],de={class:"flex flex-col sm:flex-row gap-4 mb-6"},ce={class:"relative flex-grow"},ue={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},ge={class:"inline-flex items-center justify-center gap-2 rounded-md bg-white px-4 py-2 text-sm font-semibold text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},me={key:0,class:"flex flex-col items-center justify-center py-20 bg-white rounded-xl border border-gray-200"},pe={key:1,class:"space-y-4"},xe={key:0,class:"text-center py-20 bg-white rounded-xl border-2 border-dashed border-gray-200"},ye={key:0,class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-shadow"},fe={class:"flex flex-col lg:flex-row gap-6"},be={class:"flex-shrink-0"},ve={class:"h-16 w-16 rounded-lg bg-gray-50 flex items-center justify-center border border-gray-100"},he={class:"flex-grow"},we={class:"flex flex-wrap items-center gap-2 mb-1"},_e={class:"text-lg font-bold text-gray-900"},ke={class:"inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset bg-green-50 text-green-700 ring-green-600/20"},Ce={key:0,class:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-2 py-0.5 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10"},Pe={class:"text-sm text-gray-500 mb-2"},Te={class:"text-sm text-gray-600 leading-relaxed"},Se={class:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 min-w-[320px] border-t lg:border-t-0 lg:border-l border-gray-100 pt-4 lg:pt-0 lg:pl-8"},Ue={class:"text-right flex-shrink-0"},Me={class:"text-xl font-bold text-gray-900"},Ne={class:"text-[14px] text-gray-400 font-medium"},je={class:"text-right text-[14px] text-gray-500 leading-tight min-w-[80px]"},Ve={class:"flex justify-end gap-1"},Ae={class:"font-medium text-gray-700"},Fe={class:"flex justify-end gap-1"},qe={class:"font-medium text-gray-700"},Ee={class:"flex lg:flex-row gap-1 items-center"},Oe=["onClick"],Le=["onClick"],De={key:1,class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm flex items-center gap-4 hover:border-indigo-200 transition-colors"},Be={class:"h-12 w-12 rounded bg-gray-50 flex items-center justify-center flex-shrink-0"},$e={class:"flex-grow"},Je={class:"text-sm font-bold text-gray-900"},Ke={class:"text-xs text-gray-500"},Qe=["onClick"],ze={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"},Ie={class:"w-full max-w-2xl rounded-xl bg-white shadow-2xl overflow-hidden"},Ge={class:"flex items-center justify-between border-b border-gray-100 px-6 py-4"},He={class:"text-lg font-bold text-gray-900"},Re={class:"p-6 max-h-[80vh] overflow-y-auto"},Xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},We={class:"col-span-1"},Ye={class:"col-span-1"},Ze={class:"col-span-1"},et={class:"col-span-1"},tt={class:"col-span-1"},st={class:"col-span-1"},ot={class:"col-span-1"},at={class:"col-span-1"},rt={class:"col-span-2"},lt={class:"bg-gray-50 px-6 py-4 flex justify-end gap-3"},ft={__name:"Catalog",setup(V){const v=x("My Catalog"),h=["My Catalog","Portal Items"],y=x(""),p=x(!0),g=x([]),P=x(""),f=x(!1),i=x(!1),a=x({id:"",name:"",sku:"",category:"",unit:"",price:0,tax:"",moq:"",leadTime:"",description:""}),L=o=>{i.value=!0,a.value={id:o.id,name:o.name,sku:o.sku,category:o.category,unit:o.unit||"Nos",price:o.price,tax:o.tax,moq:o.min_order_qty||1,leadTime:o.lead_time_days||"N/A",description:o.description},f.value=!0},A=K(),{secureFetch:k}=A,T=()=>_(this,null,function*(){p.value=!0;try{const o=yield k("/api/method/supplier_portal.api.get_catalog_items");if(!o.ok)throw new Error("Network response was not ok");const t=yield o.json();t&&t.message&&(g.value=t.message.items||[],P.value=t.message.current_supplier||"")}catch(o){console.error("Failed to load products:",o)}finally{p.value=!1}});Q(()=>{T()});const F=E(()=>g.value?g.value.filter(o=>{var s,b;return!y.value||((s=o.name)==null?void 0:s.toLowerCase().includes(y.value.toLowerCase()))||((b=o.sku)==null?void 0:b.toLowerCase().includes(y.value.toLowerCase()))?v.value==="My Catalog"?o.is_my_item===!0:o.is_purchase_item==1&&o.is_my_item===!1:!1}):[]),S=()=>{f.value=!1},D=()=>_(this,null,function*(){var o;if(!a.value.name||!a.value.price){alert("Please enter both product name and price");return}try{p.value=!0;const t="/api/method/supplier_portal.api.update_catalog_item",s={item_id:a.value.id,name:a.value.name,price:a.value.price,moq:a.value.moq,leadTime:a.value.leadTime,description:a.value.description,tax:a.value.tax},q=yield(yield k(t,{method:"POST",body:JSON.stringify(s)})).json();q.message==="success"?(S(),yield T(),alert("Product updated successfully!")):alert("Error: "+(((o=q.message)==null?void 0:o.message)||"Failed to update product"))}catch(t){console.error("Update failed:",t),alert("An error occurred during submission.")}finally{p.value=!1}}),B=o=>_(this,null,function*(){if(!A.user){alert("Please login to add items to your catalog.");return}try{const s=yield(yield k("/api/method/supplier_portal.api.add_to_catalog",{method:"POST",body:JSON.stringify({item_id:o.id})})).json();s.message==="success"?(o.is_my_item=!0,alert(`${o.name} added to your catalog!`)):alert("Failed: "+(s.message||"Unknown error"))}catch(t){console.error("Failed to add item:",t)}}),$=o=>_(this,null,function*(){if(confirm("Are you sure you want to remove this item?"))try{(yield(yield k("/api/method/supplier_portal.api.remove_from_catalog",{method:"POST",body:JSON.stringify({item_id:o})})).json()).message==="success"&&(yield T())}catch(t){console.error("Delete request failed:",t)}}),J=E(()=>[{name:"Total Products",value:g.value.filter(o=>o.is_my_item).length,icon:C,color:"text-indigo-600",bg:"bg-indigo-50"},{name:"Active Items",value:g.value.filter(o=>o.is_my_item&&o.status==="active").length,icon:R,color:"text-green-600",bg:"bg-green-50"},{name:"Pending Approval",value:g.value.filter(o=>o.is_my_item&&o.status==="pending").length,icon:X,color:"text-orange-600",bg:"bg-orange-50"},{name:"Matched Tenders",value:g.value.reduce((o,t)=>t.is_my_item?o+(t.matches||0):o,0),icon:O,color:"text-blue-600",bg:"bg-blue-50"}]);return(o,t)=>(l(),n("div",se,[t[32]||(t[32]=e("div",{class:"flex items-center justify-between mb-8"},[e("div",null,[e("h1",{class:"text-3xl font-bold tracking-tight text-gray-900"},"Product Catalog"),e("p",{class:"mt-1 text-sm text-gray-500"},"Manage your product catalog and pricing.")])],-1)),e("div",oe,[(l(!0),n(M,null,N(J.value,s=>(l(),n("div",{key:s.name,class:"rounded-lg bg-white px-4 py-5 shadow sm:p-6 border border-gray-100 flex items-center gap-4"},[e("div",{class:j([s.bg,"rounded-md p-3"])},[(l(),G(H(s.icon),{class:j([s.color,"h-6 w-6"])},null,8,["class"]))],2),e("div",null,[e("dt",ae,r(s.name),1),e("dd",re,r(s.value),1)])]))),128))]),e("div",le,[e("div",ne,[(l(),n(M,null,N(h,s=>e("button",{key:s,onClick:b=>v.value=s,class:j([v.value===s?"bg-indigo-50 text-indigo-700 ring-1 ring-inset ring-indigo-700/10 font-semibold":"text-gray-500 hover:text-gray-700 hover:bg-gray-50","rounded-md px-4 py-2 text-sm font-medium transition-colors"])},r(s),11,ie)),64))])]),e("div",de,[e("div",ce,[e("div",ue,[c(u(W),{class:"h-4 w-4 text-gray-400"})]),d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s),type:"text",class:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 shadow-sm",placeholder:"Search products..."},null,512),[[m,y.value]])]),e("button",ge,[c(u(Y),{class:"h-4 w-4 text-gray-500"}),t[10]||(t[10]=w(" Filters ",-1))])]),p.value?(l(),n("div",me,[...t[11]||(t[11]=[e("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mb-4"},null,-1),e("p",{class:"text-gray-500"},"Fetching products...",-1)])])):(l(),n("div",pe,[F.value.length===0?(l(),n("div",xe,[c(u(C),{class:"mx-auto h-12 w-12 text-gray-300 mb-4"}),t[12]||(t[12]=e("h3",{class:"text-sm font-semibold text-gray-900"},"No products found",-1)),t[13]||(t[13]=e("p",{class:"mt-1 text-sm text-gray-500"},"Try adjusting your search or filters.",-1))])):U("",!0),(l(!0),n(M,null,N(F.value,s=>(l(),n("div",{key:s.id},[v.value==="My Catalog"?(l(),n("div",ye,[e("div",fe,[e("div",be,[e("div",ve,[c(u(C),{class:"h-8 w-8 text-gray-400"})])]),e("div",he,[e("div",we,[e("h3",_e,r(s.name),1),e("span",ke,r(s.status),1),s.matches?(l(),n("span",Ce,[c(u(O),{class:"h-3 w-3"}),w(" "+r(s.matches)+" matches ",1)])):U("",!0)]),e("div",Pe,[t[14]||(t[14]=e("span",{class:"font-bold text-gray-700"},"SKU:",-1)),w(" "+r(s.sku||"N/A")+" ",1),t[15]||(t[15]=e("span",{class:"mx-2 text-gray-300"},"•",-1)),t[16]||(t[16]=e("span",{class:"font-bold text-gray-700"},"Category:",-1)),w(" "+r(s.category)+" ",1),t[17]||(t[17]=e("span",{class:"mx-2 text-gray-300"},"•",-1)),t[18]||(t[18]=e("span",{class:"font-bold text-gray-700"},"Unit:",-1)),w(" "+r(s.unit||"Nos"),1)]),e("p",Te,r(s.description),1)]),e("div",Se,[e("div",Ue,[e("div",Me,"₹"+r(Number(s.price).toLocaleString()),1),e("div",Ne,"+ "+r(s.tax),1)]),e("div",je,[e("div",Ve,[t[19]||(t[19]=e("span",{class:"text-gray-400"},"Lead:",-1)),e("span",Ae,r(s.leadTime),1)]),e("div",Fe,[t[20]||(t[20]=e("span",{class:"text-gray-400"},"MOQ:",-1)),e("span",qe,r(s.moq),1)])]),e("div",Ee,[e("button",{onClick:b=>L(s),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-md transition-colors"},[c(u(Z),{class:"h-4 w-4"})],8,Oe),e("button",{onClick:b=>$(s.id),class:"p-2 text-red-500 hover:bg-red-50 rounded-md transition-colors"},[c(u(ee),{class:"h-4 w-4"})],8,Le)])])])])):(l(),n("div",De,[e("div",Be,[c(u(C),{class:"h-6 w-6 text-gray-400"})]),e("div",$e,[e("h3",Je,r(s.name),1),e("p",Ke,"Category: "+r(s.category)+" • Unit: "+r(s.unit),1)]),e("button",{onClick:b=>B(s),class:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md text-sm font-semibold text-gray-700 hover:bg-gray-50 transition whitespace-nowrap"},[c(u(te),{class:"h-4 w-4"}),t[21]||(t[21]=w(" Add to My Catalog ",-1))],8,Qe)]))]))),128))])),f.value?(l(),n("div",ze,[e("div",Ie,[e("div",Ge,[e("h3",He,r(i.value?"Edit Product":"Add New Product"),1),e("button",{onClick:S,class:"text-gray-400 hover:text-gray-500"},[c(u(z),{class:"h-5 w-5"})])]),e("div",Re,[e("div",Xe,[e("div",We,[t[22]||(t[22]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Product Name",-1)),d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.name=s),type:"text",placeholder:"Enter product name",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.name]])]),e("div",Ye,[t[23]||(t[23]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"SKU",-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.sku=s),type:"text",placeholder:"Enter SKU",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.sku]])]),e("div",Ze,[t[24]||(t[24]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Category",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.category=s),type:"text",placeholder:"e.g. Hardware",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.category]])]),e("div",et,[t[25]||(t[25]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Unit of Measure",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.unit=s),type:"text",placeholder:"e.g. Nos",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.unit]])]),e("div",tt,[t[26]||(t[26]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Base Price (₹)",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.price=s),type:"number",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.price]])]),e("div",st,[t[28]||(t[28]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"GST Rate (%)",-1)),d(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.tax=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[...t[27]||(t[27]=[e("option",{value:"18%"},"18%",-1),e("option",{value:"12%"},"12%",-1),e("option",{value:"5%"},"5%",-1)])],512),[[I,a.value.tax]])]),e("div",ot,[t[29]||(t[29]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"MOQ",-1)),d(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.moq=s),type:"number",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.moq]])]),e("div",at,[t[30]||(t[30]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Lead Time (Days)",-1)),d(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.leadTime=s),type:"text",placeholder:"Delivery lead time",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.leadTime]])]),e("div",rt,[t[31]||(t[31]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Specifications",-1)),d(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=s=>a.value.description=s),rows:"3",placeholder:"Enter product specifications...",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.description]])])])]),e("div",lt,[e("button",{onClick:S,class:"px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-100 rounded-md"},"Cancel"),e("button",{onClick:D,class:"px-6 py-2 bg-indigo-600 text-sm font-semibold text-white rounded-md hover:bg-indigo-500 shadow-sm"},r(i.value?"Update Catalog":"Add to Catalog"),1)])])])):U("",!0)]))}};export{ft as default};
//# sourceMappingURL=Catalog-Bsq_dRTy.js.map
