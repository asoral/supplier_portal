var _=(V,v,h)=>new Promise((f,p)=>{var g=l=>{try{x(h.next(l))}catch(a){p(a)}},P=l=>{try{x(h.throw(l))}catch(a){p(a)}},x=l=>l.done?f(l.value):Promise.resolve(l.value).then(g,P);x((h=h.apply(V,v)).next())});import{m as y,l as Q,p as z,y as q,P as C,a as n,b as e,k as M,e as d,f as b,u,F as j,r as N,q as c,v as m,t as r,X as I,D as G,o as i,n as A,h as H,i as R}from"./index-D5a6mMu4.js";import{C as X}from"./circle-check-big-aW9m5Tw2.js";import{C as W}from"./clock-P9NpKmqW.js";import{T as E}from"./trending-up-BVxD90K5.js";import{P as O}from"./plus-BlpZHZG-.js";import{S as Y}from"./search-B3Y6NaGt.js";import{F as Z}from"./funnel-C6H7Mq0R.js";import{P as ee}from"./pen-Bd0BcxT3.js";import{T as te}from"./trash-2-CS1Vq9_X.js";const se={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8"},oe={class:"flex items-center justify-between mb-8"},ae={class:"grid grid-cols-1 gap-4 sm:grid-cols-4 mb-8"},re={class:"truncate text-sm font-medium text-gray-500"},le={class:"mt-1 text-2xl font-semibold tracking-tight text-gray-900"},ie={class:"mb-6"},ne={class:"flex space-x-2"},de=["onClick"],ue={class:"flex flex-col sm:flex-row gap-4 mb-6"},ce={class:"relative flex-grow"},ge={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},me={class:"inline-flex items-center justify-center gap-2 rounded-md bg-white px-4 py-2 text-sm font-semibold text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},pe={key:0,class:"flex flex-col items-center justify-center py-20 bg-white rounded-xl border border-gray-200"},xe={key:1,class:"space-y-4"},ye={key:0,class:"text-center py-20 bg-white rounded-xl border-2 border-dashed border-gray-200"},fe={key:0,class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-shadow"},be={class:"flex flex-col lg:flex-row gap-6"},ve={class:"flex-shrink-0"},he={class:"h-16 w-16 rounded-lg bg-gray-50 flex items-center justify-center border border-gray-100"},we={class:"flex-grow"},_e={class:"flex flex-wrap items-center gap-2 mb-1"},ke={class:"text-lg font-bold text-gray-900"},Ce={class:"inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset bg-green-50 text-green-700 ring-green-600/20"},Pe={key:0,class:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-2 py-0.5 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10"},Se={class:"text-sm text-gray-500 mb-2"},Te={class:"text-sm text-gray-600 leading-relaxed"},Ue={class:"flex lg:flex-col items-center lg:items-end justify-between lg:justify-center gap-1 min-w-[180px] border-t lg:border-t-0 lg:border-l border-gray-100 pt-4 lg:pt-0 lg:pl-8"},Me={class:"text-right"},je={class:"text-2xl font-bold text-gray-900"},Ne={class:"text-xs text-gray-400 font-medium"},Ae={class:"lg:mt-4 text-right text-sm text-gray-500 leading-tight"},Ve={class:"flex justify-end gap-1"},Fe={class:"font-medium text-gray-700"},qe={class:"flex justify-end gap-1"},Ee={class:"font-medium text-gray-700"},Oe={class:"flex gap-2 mt-4"},Le=["onClick"],De=["onClick"],Be={key:1,class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm flex items-center gap-4 hover:border-indigo-200 transition-colors"},$e={class:"h-12 w-12 rounded bg-gray-50 flex items-center justify-center flex-shrink-0"},Je={class:"flex-grow"},Ke={class:"text-sm font-bold text-gray-900"},Qe={class:"text-xs text-gray-500"},ze=["onClick"],Ie={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"},Ge={class:"w-full max-w-2xl rounded-xl bg-white shadow-2xl overflow-hidden"},He={class:"flex items-center justify-between border-b border-gray-100 px-6 py-4"},Re={class:"text-lg font-bold text-gray-900"},Xe={class:"p-6 max-h-[80vh] overflow-y-auto"},We={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ye={class:"col-span-1"},Ze={class:"col-span-1"},et={class:"col-span-1"},tt={class:"col-span-1"},st={class:"col-span-1"},ot={class:"col-span-1"},at={class:"col-span-1"},rt={class:"col-span-1"},lt={class:"col-span-2"},it={class:"bg-gray-50 px-6 py-4 flex justify-end gap-3"},bt={__name:"Catalog",setup(V){const v=y("My Catalog"),h=["My Catalog","Portal Items"],f=y(""),p=y(!0),g=y([]),P=y(""),x=y(!1),l=y(!1),a=y({id:"",name:"",sku:"",category:"",unit:"",price:0,tax:"",moq:"",leadTime:"",description:""}),L=o=>{l.value=!0,a.value={id:o.id,name:o.name,sku:o.sku,category:o.category,unit:o.unit||"Nos",price:o.price,tax:o.tax,moq:o.min_order_qty||1,leadTime:item.lead_time_days||"N/A",description:o.description},x.value=!0},S=Q(),{secureFetch:k}=S,T=()=>_(this,null,function*(){p.value=!0;try{const o=yield k("/api/method/supplier_portal.api.get_catalog_items");if(!o.ok)throw new Error("Network response was not ok");const t=yield o.json();t&&t.message&&(g.value=t.message.items||[],P.value=t.message.current_supplier||"")}catch(o){console.error("Failed to load products:",o)}finally{p.value=!1}});z(()=>{T()});const F=q(()=>g.value?g.value.filter(o=>{var s,w;return!f.value||((s=o.name)==null?void 0:s.toLowerCase().includes(f.value.toLowerCase()))||((w=o.sku)==null?void 0:w.toLowerCase().includes(f.value.toLowerCase()))?v.value==="My Catalog"?o.is_my_item===!0:o.is_purchase_item==1&&o.is_my_item===!1:!1}):[]),D=()=>{if(!S.user){alert("Please login to manage products.");return}l.value=!1,a.value={id:"",name:"",sku:"",category:"",unit:"",price:0,tax:"",moq:"",leadTime:"",description:""},x.value=!0},U=()=>{x.value=!1},B=()=>_(this,null,function*(){if(!a.value.name){alert("Please enter a product name");return}try{p.value=!0;const o=l.value?"/api/method/supplier_portal.api.update_supplier_item":"/api/method/supplier_portal.api.create_supplier_item",s=yield(yield k(o,{method:"POST",body:JSON.stringify(a.value)})).json();s.message==="success"?(U(),yield T(),alert(l.value?"Product updated successfully!":"Product added successfully!")):alert("Error: "+(s.message||"Failed to save product"))}catch(o){console.error("Submission failed:",o),alert("An error occurred while saving the product.")}finally{p.value=!1}}),$=o=>_(this,null,function*(){if(!S.user){alert("Please login to add items to your catalog.");return}try{const s=yield(yield k("/api/method/supplier_portal.api.add_to_catalog",{method:"POST",body:JSON.stringify({item_id:o.id})})).json();s.message==="success"?(o.is_my_item=!0,alert(`${o.name} added to your catalog!`)):alert("Failed: "+(s.message||"Unknown error"))}catch(t){console.error("Failed to add item:",t)}}),J=o=>_(this,null,function*(){if(confirm("Are you sure you want to remove this item?"))try{(yield(yield k("/api/method/supplier_portal.api.remove_from_catalog",{method:"POST",body:JSON.stringify({item_id:o})})).json()).message==="success"&&(yield T())}catch(t){console.error("Delete request failed:",t)}}),K=q(()=>[{name:"Total Products",value:g.value.filter(o=>o.is_my_item).length,icon:C,color:"text-indigo-600",bg:"bg-indigo-50"},{name:"Active Items",value:g.value.filter(o=>o.is_my_item&&o.status==="active").length,icon:X,color:"text-green-600",bg:"bg-green-50"},{name:"Pending Approval",value:g.value.filter(o=>o.is_my_item&&o.status==="pending").length,icon:W,color:"text-orange-600",bg:"bg-orange-50"},{name:"Matched Tenders",value:g.value.reduce((o,t)=>t.is_my_item?o+(t.matches||0):o,0),icon:E,color:"text-blue-600",bg:"bg-blue-50"}]);return(o,t)=>(i(),n("div",se,[e("div",oe,[t[11]||(t[11]=e("div",null,[e("h1",{class:"text-3xl font-bold tracking-tight text-gray-900"},"Product Catalog"),e("p",{class:"mt-1 text-sm text-gray-500"},"Manage your product catalog and pricing.")],-1)),e("button",{onClick:D,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 flex items-center gap-2"},[d(u(O),{class:"h-4 w-4"}),t[10]||(t[10]=b(" Add Product ",-1))])]),e("div",ae,[(i(!0),n(j,null,N(K.value,s=>(i(),n("div",{key:s.name,class:"rounded-lg bg-white px-4 py-5 shadow sm:p-6 border border-gray-100 flex items-center gap-4"},[e("div",{class:A([s.bg,"rounded-md p-3"])},[(i(),H(R(s.icon),{class:A([s.color,"h-6 w-6"])},null,8,["class"]))],2),e("div",null,[e("dt",re,r(s.name),1),e("dd",le,r(s.value),1)])]))),128))]),e("div",ie,[e("div",ne,[(i(),n(j,null,N(h,s=>e("button",{key:s,onClick:w=>v.value=s,class:A([v.value===s?"bg-indigo-50 text-indigo-700 ring-1 ring-inset ring-indigo-700/10 font-semibold":"text-gray-500 hover:text-gray-700 hover:bg-gray-50","rounded-md px-4 py-2 text-sm font-medium transition-colors"])},r(s),11,de)),64))])]),e("div",ue,[e("div",ce,[e("div",ge,[d(u(Y),{class:"h-4 w-4 text-gray-400"})]),c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>f.value=s),type:"text",class:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 shadow-sm",placeholder:"Search products..."},null,512),[[m,f.value]])]),e("button",me,[d(u(Z),{class:"h-4 w-4 text-gray-500"}),t[12]||(t[12]=b(" Filters ",-1))])]),p.value?(i(),n("div",pe,[...t[13]||(t[13]=[e("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mb-4"},null,-1),e("p",{class:"text-gray-500"},"Fetching products...",-1)])])):(i(),n("div",xe,[F.value.length===0?(i(),n("div",ye,[d(u(C),{class:"mx-auto h-12 w-12 text-gray-300 mb-4"}),t[14]||(t[14]=e("h3",{class:"text-sm font-semibold text-gray-900"},"No products found",-1)),t[15]||(t[15]=e("p",{class:"mt-1 text-sm text-gray-500"},"Try adjusting your search or filters.",-1))])):M("",!0),(i(!0),n(j,null,N(F.value,s=>(i(),n("div",{key:s.id},[v.value==="My Catalog"?(i(),n("div",fe,[e("div",be,[e("div",ve,[e("div",he,[d(u(C),{class:"h-8 w-8 text-gray-400"})])]),e("div",we,[e("div",_e,[e("h3",ke,r(s.name),1),e("span",Ce,r(s.status),1),s.matches?(i(),n("span",Pe,[d(u(E),{class:"h-3 w-3"}),b(" "+r(s.matches)+" matches ",1)])):M("",!0)]),e("div",Se,[t[16]||(t[16]=e("span",{class:"font-bold text-gray-700"},"SKU:",-1)),b(" "+r(s.sku||"N/A")+" ",1),t[17]||(t[17]=e("span",{class:"mx-2 text-gray-300"},"•",-1)),t[18]||(t[18]=e("span",{class:"font-bold text-gray-700"},"Category:",-1)),b(" "+r(s.category)+" ",1),t[19]||(t[19]=e("span",{class:"mx-2 text-gray-300"},"•",-1)),t[20]||(t[20]=e("span",{class:"font-bold text-gray-700"},"Unit:",-1)),b(" "+r(s.unit||"Nos"),1)]),e("p",Te,r(s.description),1)]),e("div",Ue,[e("div",Me,[e("div",je,"₹"+r(Number(s.price).toLocaleString()),1),e("div",Ne,"+ "+r(s.tax),1)]),e("div",Ae,[e("div",Ve,[t[21]||(t[21]=e("span",{class:"text-gray-400"},"Lead:",-1)),e("span",Fe,r(s.leadTime),1)]),e("div",qe,[t[22]||(t[22]=e("span",{class:"text-gray-400"},"MOQ:",-1)),e("span",Ee,r(s.moq),1)])]),e("div",Oe,[e("button",{onClick:w=>L(s),class:"p-2 text-gray-400 hover:text-indigo-600 rounded-md hover:bg-gray-50 transition-colors"},[d(u(ee),{class:"h-4 w-4"})],8,Le),e("button",{onClick:w=>J(s.id),class:"p-2 text-gray-400 hover:text-red-600 rounded-md hover:bg-gray-50 transition-colors"},[d(u(te),{class:"h-4 w-4"})],8,De)])])])])):(i(),n("div",Be,[e("div",$e,[d(u(C),{class:"h-6 w-6 text-gray-400"})]),e("div",Je,[e("h3",Ke,r(s.name),1),e("p",Qe,"Category: "+r(s.category)+" • Unit: "+r(s.unit),1)]),e("button",{onClick:w=>$(s),class:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md text-sm font-semibold text-gray-700 hover:bg-gray-50 transition whitespace-nowrap"},[d(u(O),{class:"h-4 w-4"}),t[23]||(t[23]=b(" Add to My Catalog ",-1))],8,ze)]))]))),128))])),x.value?(i(),n("div",Ie,[e("div",Ge,[e("div",He,[e("h3",Re,r(l.value?"Edit Product":"Add New Product"),1),e("button",{onClick:U,class:"text-gray-400 hover:text-gray-500"},[d(u(I),{class:"h-5 w-5"})])]),e("div",Xe,[e("div",We,[e("div",Ye,[t[24]||(t[24]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Product Name",-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.name=s),type:"text",placeholder:"Enter product name",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.name]])]),e("div",Ze,[t[25]||(t[25]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"SKU",-1)),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.sku=s),type:"text",placeholder:"Enter SKU",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.sku]])]),e("div",et,[t[26]||(t[26]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Category",-1)),c(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.category=s),type:"text",placeholder:"e.g. Hardware",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.category]])]),e("div",tt,[t[27]||(t[27]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Unit of Measure",-1)),c(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.unit=s),type:"text",placeholder:"e.g. Nos",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.unit]])]),e("div",st,[t[28]||(t[28]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Base Price (₹)",-1)),c(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.price=s),type:"number",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.price]])]),e("div",ot,[t[30]||(t[30]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"GST Rate (%)",-1)),c(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.tax=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[...t[29]||(t[29]=[e("option",{value:"18%"},"18%",-1),e("option",{value:"12%"},"12%",-1),e("option",{value:"5%"},"5%",-1)])],512),[[G,a.value.tax]])]),e("div",at,[t[31]||(t[31]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"MOQ",-1)),c(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.moq=s),type:"number",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.moq]])]),e("div",rt,[t[32]||(t[32]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Lead Time (Days)",-1)),c(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.leadTime=s),type:"text",placeholder:"Delivery lead time",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.leadTime]])]),e("div",lt,[t[33]||(t[33]=e("label",{class:"block text-xs font-bold uppercase tracking-wider text-gray-500 mb-1"},"Specifications",-1)),c(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=s=>a.value.description=s),rows:"3",placeholder:"Enter product specifications...",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[m,a.value.description]])])])]),e("div",it,[e("button",{onClick:U,class:"px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-100 rounded-md"},"Cancel"),e("button",{onClick:B,class:"px-6 py-2 bg-indigo-600 text-sm font-semibold text-white rounded-md hover:bg-indigo-500 shadow-sm"},r(l.value?"Update Catalog":"Add to Catalog"),1)])])])):M("",!0)]))}};export{bt as default};
//# sourceMappingURL=Catalog-YcCzRmb_.js.map
